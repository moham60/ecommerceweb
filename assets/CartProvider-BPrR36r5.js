import{r as a,j as k}from"./index-Bg-VFgPW.js";import{a as c}from"./axios-upsvKRUO.js";import{authenticateObj as D}from"./Authentication-boFy11Eo.js";const L=a.createContext();function q({children:p}){const{token:s}=a.useContext(D),[h,o]=a.useState(0),[C,n]=a.useState(0),[g,u]=a.useState([]),[O,I]=a.useState(null),[l,v]=a.useState(null),[x,e]=a.useState(!1),[S,P]=a.useState(null),[y,j]=a.useState(!1);async function w(t){return e(!0),await c.post("https://ecommerce.routemisr.com/api/v1/cart",{productId:t},{headers:{token:s}}).then(()=>(e(!1),i(),!0)).catch(r=>(console.log(r),e(!1),!1))}function i(){e(!0),c.get("https://ecommerce.routemisr.com/api/v1/cart",{headers:{token:s}}).then(t=>(console.log(t),e(!1),v(t.data.data.cartOwner),I(t.data.cartId),n(t.data.numOfCartItems),u(t.data.data.products),o(t.data.data.totalCartPrice),!0)).catch(t=>(e(!1),console.log(t),!1))}async function f(){return e(!0),c.get(`https://ecommerce.routemisr.com/api/v1/orders/user/${l}`).then(t=>(console.log(t.data),e(!1),P(t.data),console.log(t.data),j(!0),!0)).catch(t=>(e(!1),console.log(t),!1))}a.useEffect(()=>{s&&(i(),l&&f())},[s,l]);async function E(t,m){return e(!0),c.put(`https://ecommerce.routemisr.com/api/v1/cart/${m}`,{count:t},{headers:{token:s}}).then(d=>(e(!1),n(d.data.numOfCartItems),u(d.data.data.products),o(d.data.data.totalCartPrice),!0)).catch(d=>(console.log(d),e(!1),!1))}async function U(t){return e(!0),await c.delete(`https://ecommerce.routemisr.com/api/v1/cart/${t}`,{headers:{token:s}}).then(r=>(e(!1),n(r.data.numOfCartItems),u(r.data.data.products),o(r.data.data.totalCartPrice),!0)).catch(r=>(console.log(r),e(!1),!1))}async function $(){return e(!0),await c.delete("https://ecommerce.routemisr.com/api/v1/cart",{headers:{token:s}}).then(()=>(u([]),e(!1),n(0),o(0),!0)).catch(()=>(e(!1),!1))}function b(){o(0),n(0),o(0),u([])}return k.jsx(L.Provider,{value:{addtoCart:w,getUserCartData:i,totalCartPrice:h,numOfCartItems:C,products:g,updateCartQuantity:E,removeCartItem:U,deleteCartUser:$,cartId:O,resetValues:b,userId:l,isLoadingCartOperation:x,getUserOders:f,userOrders:S,isOrderCreated:y},children:p})}export{L as cartContext,q as default};
